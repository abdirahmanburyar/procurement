# Copy and paste these commands on your VPS to fix the missing secrets

# Step 1: Find the namespace
kubectl get pods --all-namespaces | grep api-gateway

# Step 2: Create secrets (replace 'procurement' with your namespace from Step 1)
# If no namespace found, use 'default'

NAMESPACE="procurement"  # Change this to your namespace

# Create app-secrets
kubectl create secret generic app-secrets \
  --from-literal=jwt-secret="your-secret-key-must-be-at-least-256-bits-long-for-hs256-algorithm-change-in-production" \
  --from-literal=postgres-password="postgres" \
  --from-literal=auth-db-password="postgres" \
  --from-literal=procurement-db-password="postgres" \
  --from-literal=quotation-db-password="postgres" \
  --from-literal=po-db-password="postgres" \
  --from-literal=inventory-db-password="postgres" \
  -n $NAMESPACE

# Create app-config
kubectl create configmap app-config \
  --from-literal=eureka-url="http://eureka-server:8761/eureka/" \
  --from-literal=jwt-secret="your-secret-key-must-be-at-least-256-bits-long-for-hs256-algorithm-change-in-production" \
  --from-literal=postgres-host="postgresql" \
  --from-literal=postgres-port="5432" \
  --from-literal=postgres-user="postgres" \
  -n $NAMESPACE

# Create postgresql-secret
kubectl create secret generic postgresql-secret \
  --from-literal=postgres-password="postgres" \
  --from-literal=postgres-user="postgres" \
  -n $NAMESPACE

# Restart deployments
kubectl rollout restart deployment/api-gateway -n $NAMESPACE
kubectl rollout restart deployment/auth-service -n $NAMESPACE
kubectl rollout restart deployment/config-server -n $NAMESPACE

# Check status
kubectl get pods -n $NAMESPACE

